<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Google Tag Manager -->
{#     <script>
    (function(w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
            'gtm.start': new Date().getTime(),
            event: 'gtm.js'
        });
        var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s),
            dl = l != 'dataLayer' ? '&l=' + l : '';
        j.async = true;
        j.src =
            'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-M9D96VX');

    </script> #}
    <!-- End Google Tag Manager -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>CSP and iframe sandbox Comparison | wizardsoftheweb</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="This article presents a simple Content-Security-Policy sandbox header and iframe sandbox attribute comparison to illustrate their usage together.">
    <link rel="canonical" href="https://wizardsoftheweb.pro/csp-iframe-sandbox-comparison/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <meta property="og:site_name" content="Wizards of the Web">
    <meta property="og:type" content="article">
    <meta property="og:title" content="CSP and iframe sandbox Comparison">
    <meta property="og:description" content="This article presents a simple Content-Security-Policy sandbox header and iframe sandbox attribute comparison to illustrate their usage together.">
    <meta property="og:url" content="https://wizardsoftheweb.pro/csp-iframe-sandbox-comparison/ ">
    <meta property="article:published_time" content="2017-12-25T15:00:00.000Z">
    <meta property="article:tag" content="sandbox">
    <meta property="article:tag" content="Content-Security-Policy">
    <meta property="article:tag" content="header">
    <meta property="article:tag" content="iframe">
    <meta property="article:tag" content="attribute">
    <meta property="article:tag" content="security">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="CSP and iframe sandbox Comparison">
    <meta name="twitter:description" content="This article presents a simple Content-Security-Policy sandbox header and iframe sandbox attribute comparison to illustrate their usage together.">
    <meta name="twitter:url" content="https://wizardsoftheweb.pro/csp-iframe-sandbox-comparison/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="CJ Harries">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="sandbox, Content-Security-Policy, header, iframe, attribute, security">
    <meta name="twitter:site" content="@wizardsoftheweb">
    <meta name="twitter:creator" content="@wizardsoftheweb">
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Article",
        "publisher": {
            "@type": "Organization",
            "name": "Wizards of the Web",
            "logo": "https://blog.wizardsoftheweb.pro/content/images/2017/09/test-inverted.png"
        },
        "author": {
            "@type": "Person",
            "name": "CJ Harries",
            "url": "https://blog.wizardsoftheweb.pro/author/cj-harries/",
            "sameAs": [
                "http://wizardsoftheweb.pro",
                "https://twitter.com/wizardsoftheweb"
            ]
        },
        "headline": "CSP and iframe sandbox Comparison",
        "url": "https://wizardsoftheweb.pro/csp-iframe-sandbox-comparison/",
        "datePublished": "2017-12-25T15:00:00.000Z",
        "keywords": "sandbox, Content-Security-Policy, header, iframe, attribute, security",
        "description": "This article presents a simple Content-Security-Policy sandbox header and iframe sandbox attribute comparison to illustrate their usage together.",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://wizardsoftheweb.pro/"
        }
    }

    </script>
    {% include "partials/common-fonts.j2" %}
    {% include "partials/bootstrap-styles.j2" %}
    <style>
    html,
    body {
        height: 100%;
        position: relative;
        font-size: 16px;
        font-family: "Lato", serif;
    }

    #main-nav {
        box-shadow: 0 10px 10px -5px rgba(55, 90, 127, 0.4);
    }

    /*#main-nav,*/
    #main-nav ul.nav>li {
        max-height: 60px;
        overflow-y: hidden;
    }

    #main-nav .scroll-spy-only {
        display: none;
    }

    body>article {
        margin-top: 70px;
    }

    footer {
        margin-bottom: 20vh;
    }

    body>* a>code {
        color: inherit;
    }

    body>* code {
        font-family: "Roboto Mono", monospace;
        padding: 0rem 0.4rem;
        color: #f8f8f2;
        background-color: #1b1d1e;
        border: 1px solid #505354;
    }

    header {
        margin-bottom: 20px;
    }

    div.list-group {
        margin-bottom: 0;
    }

    #embed-here iframe {
        width: 100%;
        background-color: white;
        border: 3px solid black;
        min-height: 150px;
    }

    .opt-disabled {
        cursor: not-allowed;
    }

    th.disabled span {
        opacity: .65;
    }

    #sandbox-controls {
        display: flex;
        flex-flow: row;
        align-items: center;
        justify-content: center;
    }

    #sandbox-controls table {
        display: block;
        width: auto;
    }

    th:first-of-type {
        text-align: right;
    }

    td,
    th {
        text-align: center;
    }

    @media screen and (max-width: 991px) {
        #main-nav .navbar-header {
            float: none;
        }

        #main-nav .col-sm-12 {
            padding: 0;
        }

        #main-nav .container {
            width: 100%;
        }
    }

    @media (min-width: 801px) and (max-width: 991px) {
        #main-nav .col-sm-12 {
            display: flex;
            flex-flow: row;
            align-items: center;
            justify-content: center;
        }
    }

    @media screen and (max-width: 800px) {

        #main-nav .collapse.navbar-collapse {
            display: none !important;
        }

        #main-nav .collapse.navbar-collapse.in {
            display: block !important;
        }

        #main-nav ul.nav.navbar-nav li {
            float: none;
        }

        #main-nav .navbar-brand {
            margin-left: 0;
        }

        #main-nav .navbar-header .navbar-toggle {
            display: block;
        }
    }

    @media screen and (max-width: 420px) {
        #main-nav .shrink {
            display: none;
        }
    }

    </style>
</head>

<body data-spy="scroll" data-target="#main-nav" data-offset="60">
{#     <!-- Google Tag Manager (noscript) -->
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-M9D96VX" height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) --> #}
    <nav id="main-nav" class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navCollapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="#top"><code class="shrink">CSP|iframe</code> <code>sandbox</code> Comparison</a>
                    </div>
                    <div id="navCollapse" class="collapse navbar-collapse">
                        <ul class="nav navbar-nav">
                            <li class="scroll-spy-only nav-item"><a href="#top">Top</a>
                            </li>
                            <li class="nav-item"><a href="#privacy">Privacy</a>
                            </li>
                            <li class="nav-item"><a href="#overview">Overview</a>
                            </li>
                            <li class="nav-item"><a href="#sandbox-demo"><code>sandbox</code> Demo</a>
                            </li>
                            <li class="nav-item"><a href="#other-stuff">Other Stuff</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    <article class="container">
        <header class="row" id="top">
            <h1 class="col-md-12"><code>CSP</code> and <code>iframe</code> <code>sandbox</code> Comparison</h1>
        </header>
        <section class="row" id="privacy">
            <h2 class="col-md-12">Privacy</h2>
            <p class="col-md-12">
                If you've loaded this page on my website, <code>wizardsoftheweb.pro</code>, you should know that I'm actively tracking your usage via <a href="https://analytics.google.com/" target="_blank">Google Analytics</a>. Google collects <a href="https://www.google.com/policies/privacy/#infocollect" target="_blank">quite a bit of information</a> which is then <a href="https://www.google.com/policies/privacy/#infouse" target="_blank">shared across Google apps</a>, including Google Analytics.
            </p>
            <p class="col-md-12">
                As far as I know, Google Analytics does not respect <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/DNT" target="_blank">the Do Not Track header</a>. To opt out on my site, install the relevant <a href="https://tools.google.com/dlpage/gaoptout" target="_blank">Google Analytics Opt-out Browser Add-on</a>. I also highly recommend reading <a href="https://www.eff.org/issues/do-not-track" target="_blank">EFF's DNT overview</a> and installing <a href="https://www.eff.org/privacybadger" target="_blank">EFF's Privacy Badger</a>.
            </p>
            <p class="col-md-12">
                If you're cool with me (and by extension Google) tracking your usage, I really appreciate it. I'm curious about how you interact with my content and eventually want to play with the data.
            </p>
            <div class="col-md-6 col-md-push-3 col-sm-8 col-sm-push-2 col-xs-12">
                <div class="panel panel-info">
                    <div class="panel-heading">
                        Monitored Events
                    </div>
                    <div class="list-group">
                        <a href="https://support.google.com/tagmanager/answer/6106961?hl=en#Pageview" target="gtmhelp" class="list-group-item">Page views <span class="badge"><span class="glyphicon glyphicon-new-window"></span></span></a>
                        <a href="https://support.google.com/tagmanager/answer/6106961?hl=en#scroll" target="gtmhelp" class="list-group-item">Scroll depth <span class="badge"><span class="glyphicon glyphicon-new-window"></span></span></a>
                        <a href="https://support.google.com/tagmanager/answer/6106961?hl=en#Click" target="gtmhelp" class="list-group-item">Clicks on <code>.btn</code>s and <code>a</code>nchors (links) <span class="badge"><span class="glyphicon glyphicon-new-window"></span></span></a>
                        <a href="https://support.google.com/tagmanager/answer/6106961?hl=en#HistoryChange" target="gtmhelp" class="list-group-item">History changes <span class="badge"><span class="glyphicon glyphicon-new-window"></span></span></a>
                    </div>
                </div>
            </div>
        </section>
        <section class="row" id="overview">
            <h2 class="col-md-12">Overview</h2>
            <p class="col-md-12">
                This page attempts to illustrate how <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/sandbox" target="_blank"><code>Content-Security-Policy</code> <code>sandbox</code> headers</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attr-sandbox" target="_blank"><code>iframe</code> <code>sandbox</code> attributes</a> interact. I couldn't find any practical examples and wasn't sure how this would actually turn out, so I built this. <strong>tl;dr:</strong> always set the <code>iframe</code> attribute; also set the <code>CSP</code> header when you can.
            </p>
            <p class="col-md-12">
                Using the switches below, you can change the <code>CSP</code> header and the <code>iframe</code> attribute. <a href="//github.com/wizardsoftheweb/csp-iframe-sandbox-comparison/blob/master/embed-me.php" target="_blank">The external file, <code>embed-me.php</code></a>, is a simple PHP script that creates a <code>CSP</code> header from <code>$_GET</code> params and serves a very basic HTML page with some JavaScript.
            </p>
            <p class="col-md-12">
                I didn't actually implement very many <code>sandbox</code> options. If there's something you'd like to see tested, shoot me an email (<code>cj@</code> this website) or check out <a href="//github.com/wizardsoftheweb/csp-iframe-sandbox-comparison" target="_blank">the repo</a> and make a PR or a fork.
            </p>
            <p class="col-md-12">
                <strong>WARNING:</strong> disabling both <code>sandbox</code>es or turning on <code>allow-modals</code> triggers a vanilla <code>alert</code>. <code>alert</code>s are supremely annoying and should never be used unless you're trying to illustrate specific behavior (or you need a quick way to leave content live but make sure no one uses it more than once).
            </p>
        </section>
        <section class="row" id="sandbox-demo">
            <h2 class="col-md-12"><code>sandbox</code> demo</h2>
            <div class="col-md-12" id="sandbox-controls">
                <table class="table table-responsive">
                    <thead>
                        <tr>
                            <th>Source</th>
                            <th><code>sandbox</code></th>
                            <th><code>allow-scripts</code></th>
                            <th><code>allow-modals</code></th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr id="csp-controls" data-toggle="tooltip">
                            <th><span><code>Content-Security-Policy</code> header</span></th>
                            <td class="always-enabled">
                                <input id="csp-sandbox" type="checkbox" data-toggle="toggle" data-onstyle="success" data-offstyle="danger" checked>
                            </td>
                            <td>
                                <input id="csp-allow-scripts" type="checkbox" data-toggle="toggle" data-onstyle="success" data-offstyle="danger">
                            </td>
                            <td data-toggle="tooltip">
                                <input id="csp-allow-modals" type="checkbox" data-toggle="toggle" data-onstyle="success" data-offstyle="danger" disabled>
                            </td>
                            <td class="always-enabled">
                                <button class="btn btn-primary">Reset</button>
                            </td>
                        </tr>
                        <tr id="iframe-controls" data-toggle="tooltip">
                            <th>
                                <span><code>iframe</code> attribute</span>
                            </th>
                            <td class="always-enabled">
                                <input id="iframe-sandbox" type="checkbox" data-toggle="toggle" data-onstyle="success" data-offstyle="danger" checked>
                            </td>
                            <td data-toggle="tooltip">
                                <input id="iframe-allow-scripts" type="checkbox" data-toggle="toggle" data-onstyle="success" data-offstyle="danger">
                            </td>
                            <td data-toggle="tooltip">
                                <input id="iframe-allow-modals" type="checkbox" data-toggle="toggle" data-onstyle="success" data-offstyle="danger" disabled>
                            </td>
                            <td class="always-enabled">
                                <button class="btn btn-primary">Reset</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="col-md-8 col-md-push-2 col-sm-12" id="embed-here">
            </div>
        </section>
        <footer class="row" id="other-stuff">
            <h2 class="col-md-12">Other Stuff</h2>
            <p class="col-md-12">
                I wrote about this on my blog (jk not yet; update when I do).
            </p>
            <p class="col-md-12">
                This page falls under <a href="//github.com/wizardsoftheweb/csp-iframe-sandbox-comparison/blob/master/LICENSE" target="_blank">the source's ISC license</a>.
            </p>
            <div class="col-md-6 col-md-push-3 col-sm-8 col-sm-push-2 col-xs-12">
                <div class="panel panel-info">
                    <div class="panel-heading">
                        Not My Code
                    </div>
                    <div class="list-group">
                        <a href="//jquery.com/" target="_blank" class="list-group-item">jQuery <span class="badge"><span class="glyphicon glyphicon-new-window"></span></span></a>
                        <a href="//getbootstrap.com" target="_blank" class="list-group-item">Bootstrap <span class="badge"><span class="glyphicon glyphicon-new-window"></span></span></a>
                        <a href="//bootswatch.com/darkly/" target="_blank" class="list-group-item">Bootswatch's Darkly (with some local modifications) <span class="badge"><span class="glyphicon glyphicon-new-window"></span></span></a>
                        <a href="//www.bootstraptoggle.com" target="_blank" class="list-group-item">Bootstrap Toggle <span class="badge"><span class="glyphicon glyphicon-new-window"></span></span></a>
                        <a href="//fonts.google.com/specimen/Lato" target="_blank" class="list-group-item">Lato via Google Fonts <span class="badge"><span class="glyphicon glyphicon-new-window"></span></span></a>
                        <a href="//fonts.google.com/specimen/Roboto+Mono" target="_blank" class="list-group-item"><code>Roboto Mono</code> via Google Fonts <span class="badge"><span class="glyphicon glyphicon-new-window"></span></span></a>
                    </div>
                    <div class="panel-body">
                        Also lots of <a href="https://stackoverflow.com" target="_blank">Stack Overflow</a> and probably some stuff I forgot to explicitly mention.
                    </div>
                </div>
            </div>
        </footer>
    </article>
    {% include "partials/jQuery.j2" %}
    {% include "partials/bootstrap-scripts.j2" %}
    <script>
        {% include "index.js" %}
    </script>
</body>

</html>
